/*! Tinyp2p 2015-06-29 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d={};d._send=function(a,b,c,d,e){var f=this,g={url:a,type:"GET",headers:{"Content-Type":"application/json"}};b&&(g.type=b),c&&(g.data=JSON.stringify(c)),g.success=function(a){d(a)},e?g.error=function(a){e(a)}:g.error=f.error,$.ajax(g)},d.get=function(a,b,c){this._send(a,null,null,b,c)},d.post=function(a,b,c,d){this._send(a,"post",b,c,d)},d.put=function(a,b,c,d){this._send(a,"put",b,c,d)},d["delete"]=function(a,b,c){this._send(a,"delete",null,b,c)},d.error=function(a){oc.dialog.tips("Request error: "+a.responseText),console.log("Request error:",a)},b.exports=d},{}],2:[function(a,b,c){b.exports=function(){$(function(){$("body").on("click",".zCollapse .zPanelHd",function(a){a.preventDefault();var b=$(this).parent();if(b.hasClass("active"))b.removeClass("active");else{var c=b.attr("data-group");c&&$('.zCollapse[data-group="'+c+'"]').removeClass("active"),b.addClass("active")}})})}()},{}],3:[function(a,b,c){var d={};d.format=function(a,b){a.toString().indexOf("-")>0&&(a=a.toString().replace(/-/g,"/"));var c={yyyy:"year",hh:"hours",mm:"month",dd:"date",hh:"hours",MM:"minites",ss:"seconds",ms:"millSeconds"},a=new Date(a),d={year:a.getFullYear(),month:a.getMonth()+1,date:a.getDate(),hours:a.getHours(),minites:a.getMinutes(),seconds:a.getSeconds(),millSeconds:a.getMilliseconds()};if(!b)return d.year+"-"+d.month+"-"+d.date;for(var e in c){var f=c[e],g=d[f];g.toString().length<2&&(g="0"+g.toString()),b=b.replace(e,g)}return b},d.compare=function(a,b){"string"==typeof a&&(a=a.replace(/-/g,"/")),"string"==typeof b&&(b=b.replace(/-/g,"/"));var a=new Date(a).getTime(),b=new Date(b).getTime();return a-b},d.getWeeksByYear=function(a){var b=52,a=parseInt(a+""),c=[1994,2e3,2005,2011,2016,2022,2028,2033,2039,2044,2050,2056,2061,2067,2072,2078,2084,2089,2095,2101,2107,2112,2118,2124,2129,2135,2140,2146,2152,2157,2163,2168,2174,2180,2185,2191,2196,2203,2208,2214,2220,2225,2231,2236,2242,2248,2253,2259,2264,2270,2276,2281,2287,2292,2298,2304,2310,2316,2321,2327,2332,2338,2344,2349,2355,2360,2366,2372,2377,2383,2388,2394];return-1!==$.inArray(a,c)&&b++,b},d.getWeekString=function(a){if(a||(a=new Date),"string"==typeof a)if(a.indexOf("-")>-1)a=a.replace(/-/g,"/");else{var b=a.slice(0,4),c=a.slice(4,6),d=a.slice(6);a=b+"/"+c+"/"+d}if(a=new Date(a),11==a.getMonth()&&a.getDate()>20){var e=new Date(a);if(e.setDate(e.getDate()+6-e.getDay()),e.getFullYear()>a.getFullYear())return 100*e.getFullYear()+1}var f=new Date(a.getFullYear(),0,1),d=f.getDay();if(f.setDate(8-f.getDay()),f>a)return 100*a.getFullYear()+1;var g=Math.floor((a-f)/6048e5);return 100*a.getFullYear()+g+2},d.getStartDateByWeek=function(a){if(!a)return"";"string"==typeof a&&(a=parseInt(a));var b=Math.floor(a/100),c=a%100,d=new Date(b,0,1);return d.setDate(7*(c-1)+1-d.getDay()),d},d.getNextWeek=function(a){"string"==typeof a&&(a=a.replace(/-/g,""),a=parseInt(a));var b=Math.floor(a/100),c=a%100;return 52>c?100*b+c+1:53==c?100*(b+1)+1:52==this.getWeeksByYear(b)?100*(b+1)+1:100*b+c+1},d.weekPicker=function(a){var a=$(a),b=$.trim(a.val()),c=function(){var a=$('<table class="zWeekPicker"></table>'),c=$("<thead></thead>").appendTo(a),e=new Date;b||(b=d.getWeekString(e).toString());var f=b.slice(0,4),g=b.slice(4);c.append('<tr><th colspan="100"><i class="icon-arrow-left"></i><span class="spanYear">'+f+'</span><i class="icon-arrow-right"></i></th></tr>');for(var h=$("<tbody></tbody>").appendTo(a),i=d.getWeeksByYear(f),j=$("<tr></tr>").appendTo(h),k=0;i>k;k++){k%7===0&&(j=$("<tr></tr>").appendTo(h));var l=(k+1).toString();9>k&&(l="0"+l),j.append("<td>"+l+"</td>")}h.find("td:contains("+g+")").addClass("active");var m=d.getStartDateByWeek(f+g),n=m.getTime()+5184e5;return n=d.format(n,"mmdd"),m=d.format(m,"mmdd"),h.find("tr:last-child").append('<td colspan="10" class="zWeekPickerTag"><i class="icon-clock2"></i><span>'+m+" - "+n+"</span></td>"),a.on("click","thead i",function(b){var c=$(this),e=c.parent().find(".spanYear"),f=parseInt(e.text());c.hasClass("icon-arrow-left")?f--:f++,i=d.getWeeksByYear(f),52==i?a.find("td:contains(53)").remove():0===a.find("td:contains(53)").length&&$("<td>53</td>").insertBefore(a.find("td.zWeekPickerTag")),e.html(f)}).on("mouseenter","tbody td:not(.zWeekPickerTag)",function(){var a=this.innerHTML,b=d.getStartDateByWeek(f+a),c=b.getTime()+5184e5;c=d.format(c,"mmdd"),b=d.format(b,"mmdd"),h.find("td.zWeekPickerTag span").html(b+" - "+c)}).on("mouseleave","tbody",function(){var a=d.getStartDateByWeek(f+g),b=new Date(a).getTime()+5184e5;b=d.format(b,"mmdd"),a=d.format(a,"mmdd"),h.find("td.zWeekPickerTag span").html(a+" - "+b)}).on("click",function(a){a.stopPropagation()}),$("body").on("click",function(){a.hide()}),a.appendTo("body"),a},e=function(a){var b=$(".zWeekPicker");0===b.length&&(b=c());var d=a.position(),e=$.trim(a.val());if(e&&6===e.length){var f=e.slice(0,4),g=e.slice(4);b.find(".spanYear").html(f),b.find("td.active").removeClass("active"),b.find("td:contains("+g+")").addClass("active")}b.css({left:d.left,top:d.top+a.outerHeight(),display:"block"}),b.off("click","tbody td:not(.zWeekPickerTag)").on("click","tbody td:not(.zWeekPickerTag)",function(){b.hide();var c=b.find(".spanYear").text(),d=$(this).html(),e=c+d;a.val(e),a.change()})};a=$(a),a.on("click",function(b){b.stopPropagation(),e(a)})},b.exports=d},{}],4:[function(a,b,c){var d={};d.collapse=a("./collapse"),d.tooltip=a("./tooltip"),d.popover=a("./popover"),d.modal=a("./modal"),d.ui=a("./ui"),d.ajax=a("./ajax"),d.date=a("./date"),window&&(window.oc=d),b&&b.exports&&(b.exports=d)},{"./ajax":1,"./collapse":2,"./date":3,"./modal":5,"./popover":6,"./tooltip":7,"./ui":8}],5:[function(a,b,c){b.exports={modalTemplate:'<div class="zModalCover"><div class="zModal"><div class="zModalHd"><i class="zModalClose">×</i></div><div class="zModalBd"></div></div></div>',show:function(a){var b=$(a);b.show()},_generateModal:function(a,b){var c=$(this.modalTemplate).appendTo("body");return a&&c.find(".zModalHd").append(a),c.find(".zModalBd").append(b),c.show(),c.find(".zModal").css({display:"inline-block","margin-top":c.find(".zModal").height()/-2-60}),c.on("click",function(){c.remove()}).on("click",".zModalClose",function(){c.remove()}).on("click",".zModal",function(a){a.stopPropagation()}),c},alert:function(a,b,c){1===arguments.length&&(b=arguments[0],a="");var d=this._generateModal(a,b);d.find(".zModal").append('<div class="zModalFt"><button class="zModalClose zModalAlertBtn">确定</button></div>'),c&&c(),"function"==typeof b&&b()},confirm:function(a,b,c){if(arguments.length<2)return void this.alert("Confirm arguments error");var d=this._generateModal("",a);d.find(".zModal").append('<div class="zModalFt"><button class="zModalClose zModalBtnLeft">确定</button><button class="zModalClose zModalBtnRight">取消</button></div>'),d.on("click",".zModalBtnLeft",function(){b&&b()}),d.on("click",".zModalBtnRight",function(){c&&c()})},prompt:function(a,b,c,d){if(arguments.length<2)return void this.alert("Prompt arguments error");3===arguments.length&&"boolean"==typeof c&&(d=c,c=null);var e=this._generateModal("",a);e.find(".zModal").find(".zModalBd").append('<p><input type="text" class="zIpt w"/></p>');var f=e.find("input");d&&f.attr("placeholder","必填 ..."),e.find(".zModal").append('<div class="zModalFt"><button class="zModalBtnLeft">确定</button><button class="zModalClose zModalBtnRight">取消</button></div>'),e.on("click",".zModalBtnLeft",function(){var a=f.val();!a&&d?f.focus():b&&b(a)}),e.on("click",".zModalBtnRight",function(){c&&"function"==typeof c&&c()})},init:function(){$(function(){var a=$("body"),b=function(a){var b=a.height()/-2;a.css("top","50%");var c=parseInt(a.css("top"));0>b+c?a.css({"margin-top":"0",top:0}):a.css({"margin-top":b,top:"50%"})};a.on("click","[data-modal]",function(){var c=$(this),d=c.attr("data-modal"),e=$(d);0===e.find(".zModalHd .zModalClose").length&&e.find(".zModalHd").append('<i class="zModalClose">×</i>');var f=e.parents(".zModalCover");0===f.length&&(f=$('<div class="zModalCover"></div>').append(e)),a.append(f).addClass("zModalActive"),f.css("display","block"),e.css("display","inline-block"),b(e)}).on("click",".zModal .zModalClose",function(){var b=$(this).parents(".zModalCover");b.css("display","none"),a.removeClass("zModalActive")}),$(window).on("resize",function(){var a=$(".zModalCover:visible").find(".zModal");b(a)})})}()}},{}],6:[function(a,b,c){instance=function(a){$(a.target)};b.exports=Tooltip},{}],7:[function(a,b,c){Tooltip=function(a,b){var a=$(a);b&&(a.data("zTarget")||(e(a,b),a.on("blur",function(){d(this)})))};var d=function(a){var b=$(a);b.data("zTarget")&&b.data("zTarget").remove&&b.data("zTarget").remove(),b.data("zTarget",null)},e=function(a,b){var c=$(a),d=$('<div class="zTooltipTitle">'+b+"</div>").appendTo("body"),e=c.offset(),f=e.left,g=e.top;f=f+c.outerWidth()/2-d.outerWidth()/2,g=g-d.outerHeight()-8,g<$(document).scrollTop()&&(d.removeClass("zTooltipTitle").addClass("zTooltipTitleBottom"),g=c.offset().top+c.outerHeight()+8),d.css({left:f,top:g}),c.data("zTarget",d),d.data("zTarget",c)},f=function(){$(function(){$("body").off("mouseenter",".zTooltip").off("mouseout",".zTooltip").on("mouseenter",".zTooltip",function(a){console.log("init popover"),a.preventDefault();var b=$(this),c=b.attr("title");c?(b.attr("data-zTooltipTitle",c),b.removeAttr("title")):c=b.attr("data-zTooltipTitle"),c&&e(b,c)}).on("mouseout",".zTooltip",function(){d(this)})})};f(),b.exports=Tooltip},{}],8:[function(require,module,exports){var UI={};UI.toggleBtn=function(a,b){void 0===a&&(a="ON",b="OFF");var c=this;$(".zToggleBtn, .zToggleBtnSm").each(function(){var d=$(this);c.toggleOneBtn(d,a,b)})},UI.toggleOneBtn=function(a,b,c){var d="zToggleBtn";a.removeClass("zToggleBtn"),a.hasClass("zToggleBtnSm")&&(a.removeClass("zToggleBtnSm"),d+=" zToggleBtnSm");var e=a[0].checked;e&&(d+=" active");var f=$('<span class="'+d+'"><i class="zToggleBtnON">'+b+'</i><i class="zToggleBtnOFF">'+c+"</i>"+a[0].outerHTML+"</span>");a.replaceWith(f),f.find("input").prop("checked",e),f.off("change","input").on("change","input",function(){this.checked?$(this).parents(".zToggleBtn:eq(0)").addClass("active"):$(this).parents(".zToggleBtn:eq(0)").removeClass("active")})},UI.autoComplete=function(ele,array,cb,prefix){ele=$(ele),"function"==typeof array&&(cb=array,array=null),ele.off("keyup").off("keydown").off("blur"),ele.on("keydown",function(a){var b=$(this),c=b.next("ul.zAutoComplete");return 13===a.keyCode&&c.find("li.active").length>0?(event.preventDefault(),!1):void 0}),ele.on("keyup",function(e){var ipt=$(this),ul=ipt.next("ul.zAutoComplete");if(40!==e.keyCode){if(38===e.keyCode){var focusLi=ul.find("li.active");if(0===focusLi.length)return;var prevLi=focusLi.prev("li");return void(prevLi.length>0&&(prevLi.addClass("active"),focusLi.removeClass("active")))}if(13!==e.keyCode){var source=array;if(!array){var sourceString=ipt.attr("data-source");source=sourceString?eval(sourceString):ipt.data("source")}if(source){$(".zAutoComplete").remove();var val=$.trim(this.value);if(prefix&&(val=val.replace(/.*;|.*,|.*\s/g,"")),val){var matchedArray=source.filter(function(a){return a.toUpperCase().indexOf(val.toUpperCase())>-1}),len=matchedArray.length;if(0!==len){len>8&&(len=8);for(var ul=$('<ul class="zAutoComplete"></ul>'),i=0;len>i;i++)ul.append('<li tabindex="0">'+matchedArray[i]+"</li>");var top=ipt.position().top+ipt.outerHeight(),left=ipt.position().left;ul.css({top:top,left:left}).on("click","li",function(){var a=$(this).html(),b=ipt.val();if(prefix){var c=b.match(/(.|,|\s)*(;|,|\s)/);b="",c&&c.length>0&&(b=c[0]),ipt.val(b+a)}else ipt.val(a);$(".zAutoComplete").remove(),cb&&cb(a,ipt)}).on("mouseenter","li",function(){ul.find(".active").removeClass("active"),$(this).addClass("active")}),ipt.after(ul)}}}}else{var focusLi=ul.find("li.active");if(focusLi.length>0){var slcVal=focusLi.html(),text=ipt.val();if(prefix){var mathedArray=text.match(/(.|,|\s)*(;|,|\s)/);text="",mathedArray&&mathedArray.length>0&&(text=mathedArray[0]),ipt.val(text+slcVal)}else ipt.val(slcVal);ul.remove(),cb&&cb(slcVal,ipt)}}}else{var focusLi=ul.find("li.active");if(0===focusLi.length)ul.find("li:eq(0)").addClass("active");else{var nextLi=focusLi.next("li");nextLi.length>0&&(nextLi.addClass("active"),focusLi.removeClass("active"))}}}).on("blur",function(){setTimeout(function(){$(".zAutoComplete").remove()},200)})},UI.cbx=function(){return $(".zCbx").off("change","input").on("change","input",function(){this.checked?$(this).parent().addClass("active"):$(this).parent().removeClass("active")}),{check:function(a){if(!a.hasClass("zCbx")){if(0===a.find("input:checkbox").length)return console.warn("zCkb does not contain a input:checkbox item");a.addClass("active").find("input:checkbox")[0].checked=!0}},unCheck:function(a){if(a.hasClass("zCbx")){if(0===a.find("input:checkbox").length)return console.warn("zCkb does not contain a input:checkbox item");a.removeClass("active").find("input:checkbox")[0].checked=!1}}}},UI.multiSelect=function(a){$("select.zMultiSelect").each(function(){var a=$(this),b=a.outerWidth(),c=a.outerHeight()+"px",d=a.attr("name");void 0===d&&(d="");var e=$('<div class="zMultiSelect"><div class="zMultiSelectText"></div><div class="zMultiSelectMain"><ul></ul></div></div>');e.css("width",b),e.find(".zMultiSelectText").css({height:c,"line-height":c}).html(a.attr("data-slc"));var f="";a.find("option").each(function(a,b){f+='<li><label class="zCbx"><input type="checkbox", name="'+d+'" value="'+b.value+'">'+b.innerHTML+"</label></li>"}),f+='<li><button class="btnPrimary btnXs" type="button">Confirm</button></li>',e.find("ul").html(f),a.replaceWith(e)}),UI.cbx();var b=function(){var b=$(".zMultiSelect");b.on("click",".zMultiSelectText",function(){var a=$(this).parents(".zMultiSelect:eq(0)");if(a.hasClass("active"))a.removeClass("active").find(".zMultiSelectMain").hide();else{a.addClass("active").find(".zMultiSelectMain").show();var b=this.innerHTML,c=b.split(";");a.find(".zCbx").removeClass("active").find("input:checkbox").attr("checked",!1);for(var d in c){var e=c[d],f=a.find('input:checkbox[value="'+e+'"]');f.length>0&&(f[0].checked=!0,f.parent().addClass("active"))}}}).on("click","button",function(b){var c=$(this).parents(".zMultiSelect:eq(0)"),d=$(this).parents(".zMultiSelectMain:eq(0)"),e="";d.find("input:checked").each(function(){e+=this.value+";"}),e&&(e=e.slice(0,-1)),c.removeClass("active").find(".zMultiSelectText").html(e),d.hide(),b.stopPropagation(),a&&a(c)}).click(function(a){a.stopPropagation()}),$("html").click(function(){b.removeClass("active").find(".zMultiSelectMain").hide()})};b()},UI.popOver=function(a,b,c,d){if(a=$(a),a.next(".zPopOver").length>0)return void a.next(".zPopOver").remove();var e=$('<div class="zPopOver zPopOver'+d+'"></div>');e.append('<div class="zPopOverTitle">'+b+'<i class="icon-close"></i></div>'),e.append('<div class="zPopOverContent">'+c+"</div>"),a=$(a);var f=a.position();a.after(e);var g=f.left+a.outerWidth()+20,h=f.top+a.outerHeight()/2-e.outerHeight()/2-5;"left"===d?g=f.left-e.outerWidth()-20:"top"===d?(g=f.left-e.outerWidth()/2+a.outerWidth()/2,h=f.top-e.outerHeight()-20):"bottom"===d&&(g=f.left-e.outerWidth()/2+a.outerWidth()/2,h=f.top+a.outerHeight()+20),e.css({left:g,top:h}),e.on("click",".zPopOverTitle i.icon-close",function(){e.remove()})},UI.popOverRemove=function(a){var a=$(a);a.hasClass(".zPopOver")?a.remove():a.next(".zPopOver").remove()},module.exports=UI},{}]},{},[4]);